clc
clear all
close all

%Confidence interval diagrams for ALSFRS-R changes over time
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fast patients
xFast = (1:1:8);
avgFast = [38.6421052600000,28.9157894700000,25.2941176500000,20.8518518500000,19.6428571400000,16.1428571400000,15,9.50000000000000];
LFast = [32.2531084900000,19.5297268400000,17.5019795300000,13.1025211600000,13.4138106300000,8.09960670800000,4.57566948600000,1];
UFast = [45.0311020400000,38.3018521100000,33.0862557600000,28.6011825500000,25.8719036500000,24.1861075800000,25.4243305100000,18];

% ciplot(LFast,UFast,xFast,'y');
hold on
plot(xFast,avgFast,'r','LineWidth',2);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %Intermediate patients
hold on
xIntermediate = (1:1:20);
avgIntermediate = [40.8395348800000,36.7674418600000,33.5012787700000,31.0119403000000,28.4152249100000,26.1818181800000,24.3045685300000,22.0063291100000,19.7380952400000,18.1176470600000,17.3272727300000,17.8823529400000,18.6521739100000,18.0588235300000,16.8461538500000,16.6000000000000,20.6000000000000,22,18,13];
LIntermediate = [34.8605157700000,28.8606087600000,25.0762294500000,22.5322979100000,19.5197976400000,17.3641049800000,15.4769107100000,12.3237094000000,10.0860713800000,7.80556189900000,7.41299551900000,7.55032191900000,8.25314094900000,9.00038197900000,7.14408306100000,6.85115391400000,13.3722756000000,19,11,6];
UIntermediate = [46.8185540000000,44.6742749600000,41.9263281000000,39.4915826900000,37.3106521800000,34.9995313800000,33.1322263500000,31.6889488300000,29.3901191000000,28.4297322200000,27.2415499400000,28.2143839600000,29.0512068800000,27.1172650800000,26.5482246300000,26.3488460900000,27.8277244000000,25,25,20];

% ciplot(LIntermediate,UIntermediate,xIntermediate,'y');
hold on
plot(xIntermediate,avgIntermediate,'b','LineWidth',2);
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
hold on
% % Slow patients
xSlow = (1:1:40);
avgSlow = [39.9134125600000,37.2988115400000,35.6470588200000,34.6092184400000,33.6351648400000,32.9502369700000,31.7076923100000,30.6483516500000,29.3081395300000,28.1560509600000,27.4642857100000,26.7258687300000,26.3855932200000,26.1095238100000,26.1489361700000,26.4036144600000,26.4256756800000,26.0977443600000,25.0491803300000,25.0776699000000,24.3333333300000,24.4794520500000,24.7727272700000,23.8750000000000,23.2553191500000,22.5714285700000,22.8529411800000,23.6428571400000,23.8571428600000,23.7647058800000,24.6000000000000,23.5333333300000,26,26.6666666700000,26.3333333300000,28.5000000000000,27.4285714300000,26.6000000000000,31,37.5000000000000];
LSlow = [32.1459317000000,28.2705208700000,25.8247182800000,24.8558676800000,23.9941994300000,23.4889220000000,21.9266697500000,20.6306490500000,18.9832800000000,17.1168397900000,15.8959109000000,14.7568713400000,14.2120753100000,14.1838650100000,14.0963409300000,14.6680856000000,15.4872168600000,15.4334446600000,13.8836211200000,14.0969371600000,12.9567555000000,13.5223631600000,14.3051793600000,12.8878931100000,11.9069326600000,11.7258833900000,12.3085466400000,13.7932223200000,12.9537326700000,12.2882368000000,12.7746036000000,11.2322945300000,15.0104945200000,15.6112507000000,15.2879723200000,18.7275898600000,17.2045500900000,16.0056618900000,18.1742446600000,35];
USlow = [47.6808934300000,46.3271022200000,45.4693993600000,44.3625691900000,43.2761302400000,42.4115519400000,41.4887148700000,40.6660542500000,39.6329990700000,39.1952621200000,39.0326605300000,38.6948661100000,38.5591111300000,38.0351826100000,38.2015314100000,38.1391433100000,37.3641344900000,36.7620440600000,36.2147395400000,36.0584026500000,35.7099111700000,35.4365409500000,35.2402751800000,34.8621068900000,34.6037056400000,33.4169737600000,33.3973357100000,33.4924919600000,34.7605530500000,35.2411749600000,36.4253964000000,35.8343721300000,36.9895054800000,37.7220826300000,37.3786943500000,38.2724101400000,37.6525927600000,37.1943381100000,43.8257553400000,40];

% ciplot(LSlow,USlow,xSlow,'y');
hold on
plot(xSlow,avgSlow,'g','LineWidth',2);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% hold on
% % % All patients
% xAll = (1:1:40);
% avgAll = [40.1624775600000,36.3788150800000,34.2606490900000,32.7781649200000,31.3865435400000,30.3338301000000,29.1508474600000,27.9618320600000,26.7176220800000,25.9800000000000,25.7559523800000,25.6996587000000,25.6988417000000,25.5066079300000,25.5472636800000,25.8465909100000,26.2352941200000,26.0370370400000,24.9354838700000,24.8476190500000,24.2446808500000,24.3108108100000,24.5820895500000,23.8750000000000,23.2553191500000,22.5714285700000,22.8529411800000,23.6428571400000,23.8571428600000,23.7647058800000,24.6000000000000,23.5333333300000,26,26.6666666700000,26.3333333300000,28.5000000000000,27.4285714300000,26.6000000000000,31,37.5000000000000];
% LAll = [33.1206946200000,27.4347368700000,24.7756329800000,23.1547910000000,21.6076055100000,20.4526264900000,19.0023254300000,17.2256447100000,15.7173862500000,14.3320559800000,13.8260993600000,13.5735339800000,13.4727682800000,13.5815962500000,13.4149498100000,13.9955126200000,15.3486141800000,15.4341671200000,13.7892839300000,13.8050339900000,12.8965287200000,13.3330376000000,14.0781467900000,12.8878931100000,11.9069326600000,11.7258833900000,12.3085466400000,13.7932223200000,12.9537326700000,12.2882368000000,12.7746036000000,11.2322945300000,15.0104945200000,15.6112507000000,15.2879723200000,18.7275898600000,17.2045500900000,16.0056618900000,18.1742446600000,35];
% UAll = [47.2042605000000,45.3228932900000,43.7456652000000,42.4015388500000,41.1654815600000,40.2150337200000,39.2993694800000,38.6980194100000,37.7178579100000,37.6279440200000,37.6858054000000,37.8257834300000,37.9249151200000,37.4316196100000,37.6795775500000,37.6976692000000,37.1219740600000,36.6399069500000,36.0816838100000,35.8902041100000,35.5928329800000,35.2885840300000,35.0860323100000,34.8621068900000,34.6037056400000,33.4169737600000,33.3973357100000,33.4924919600000,34.7605530500000,35.2411749600000,36.4253964000000,35.8343721300000,36.9895054800000,37.7220826300000,37.3786943500000,38.2724101400000,37.6525927600000,37.1943381100000,43.8257553400000,40];
% 
% % ciplot(LSlow,USlow,xSlow,'y');
% hold on
% plot(xAll,avgAll,'k','LineWidth',2);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
xlabel('Month');
ylabel('ALSFRS-R');
% legend('Fast', 'Intermediate', 'Slow')